# 测试生成过程监控优化方案

## 现状分析

当前项目已有以下监控组件：
- `PerformanceDashboard` - 测试执行后的性能分析
- `ProgressBar` - 终端进度条
- `StatisticsPanel` - 最终统计面板
- `MetricsManager` - Micrometer/Prometheus指标收集
- `OutputFormatter` - CLI输出格式化

**主要问题：**
1. 缺乏实时生成过程监控
2. LLM调用详情不可见
3. 阶段进度不够细粒度
4. 错误追踪不完善
5. 缺乏资源使用监控

## 优化方案

### Phase 1: 增强实时进度监控
1. 创建 `GenerationPhase` 枚举定义生成阶段
2. 创建 `GenerationProgress` 类跟踪详细进度
3. 增强 `ProgressBar` 支持多阶段显示

### Phase 2: LLM调用监控增强
1. 创建 `LLMCallMonitor` 类追踪每次LLM调用
2. 实时显示API延迟、Token使用、成本估算
3. 支持流式输出的实时显示

### Phase 3: 实时仪表板
1. 创建 `RealTimeDashboard` 类实现实时更新界面
2. 显示：当前阶段、进度、覆盖率、Token使用、耗时
3. 支持终端实时刷新

### Phase 4: 集成到核心流程
1. 修改 `IterativeOptimizer` 集成监控
2. 修改 `TestGenerator` 集成LLM监控
3. 修改 `CLICommand` 启用仪表板

## 新增文件
- `GenerationPhase.java` - 生成阶段枚举
- `GenerationProgress.java` - 生成进度跟踪
- `LLMCallMonitor.java` - LLM调用监控
- `RealTimeDashboard.java` - 实时仪表板

## 修改文件
- `IterativeOptimizer.java` - 集成监控回调
- `TestGenerator.java` - 添加LLM监控
- `ProgressBar.java` - 增强进度显示
- `OutputFormatter.java` - 增强输出格式