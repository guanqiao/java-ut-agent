# 过程监控优化方案（第二阶段）

## 当前问题分析

1. **缺少覆盖率历史趋势** - 无法看到覆盖率变化曲线
2. **缺少阶段耗时分析** - 不知道哪个阶段耗时最长
3. **缺少预计剩余时间** - 用户无法预估等待时间
4. **缺少测试方法统计** - 不知道生成了多少测试方法
5. **缺少错误详情展示** - 错误信息不够详细
6. **缺少性能趋势** - 无法看到Token消耗速率变化

## 优化方案

### Phase 1: 增强数据收集
1. 在 `GenerationProgress` 中添加：
   - 覆盖率历史记录列表
   - 阶段耗时记录
   - 测试方法计数
   - 性能指标（Token/秒）

2. 创建 `PhaseTiming` 类记录阶段耗时

### Phase 2: 增强仪表板显示
1. 添加覆盖率趋势迷你图（ASCII图表）
2. 显示各阶段耗时占比
3. 添加预计剩余时间（ETA）
4. 显示测试方法数量
5. 添加性能指标（Token/秒、测试/分钟）

### Phase 3: 增强错误处理
1. 创建 `ErrorDetail` 类记录详细错误信息
2. 支持错误堆栈展示
3. 添加错误恢复建议

### Phase 4: 集成到核心流程
1. 修改 `IterativeOptimizer` 记录阶段耗时
2. 修改 `TestGenerator` 记录测试方法数量

## 新增/修改文件

**新增：**
- `PhaseTiming.java` - 阶段耗时记录
- `CoverageTrend.java` - 覆盖率趋势

**修改：**
- `GenerationProgress.java` - 增强数据收集
- `RealTimeDashboard.java` - 增强显示
- `IterativeOptimizer.java` - 集成耗时记录